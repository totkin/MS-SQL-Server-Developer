## Домашнее задание 05
*Оконные функции*

фев'24
<hr>

### Структура каталога

```
homework_05
├── hw_window_functions_tasks-188-334649.sql  - Домашняя работа запросами SQL
├── ReadMe.md                                 - Данный файл
└── _work                                     - Рабочая папка с материалами /оставлена для своих задач автора/

```

<hr>

[Ссылка на файл с ДЗ05](hw_window_functions_tasks-188-334649.sql)
<hr>

### Описание ДЗ

**Цель:**
В этом ДЗ вы научитесь писать запрос с временной таблицей и с табличной переменной.

**Описание/Пошаговая инструкция выполнения домашнего задания:**
Более подробно задание описано в материалах в личном кабинете.

1. Сделать расчет суммы продаж нарастающим итогом по месяцам с 2015 года
(в рамках одного месяца он будет одинаковый, нарастать будет в течение времени выборки).
Нарастающий итог должен быть без оконной функции.
2. Сделайте расчет суммы нарастающим итогом в предыдущем запросе с помощью оконной функции.
Сравните производительность запросов 1 и 2 с помощью set statistics time, io on
3. Вывести список 2х самых популярных продуктов (по количеству проданных)
в каждом месяце за 2016 год (по 2 самых популярных продукта в каждом месяце).
Функции одним запросом
4. Посчитайте по таблице товаров (в вывод также должен попасть ид товара, название, брэнд и цена):
   - пронумеруйте записи по названию товара, так чтобы при изменении буквы алфавита нумерация начиналась заново
   - посчитайте общее количество товаров и выведете полем в этом же запросе
   - посчитайте общее количество товаров в зависимости от первой буквы названия товара
   - отобразите следующий id товара исходя из того, что порядок отображения товаров по имени
   - предыдущий ид товара с тем же порядком отображения (по имени)
   - названия товара 2 строки назад, в случае если предыдущей строки нет нужно вывести "No items"
   - сформируйте 30 групп товаров по полю вес товара на 1 шт

Для этой задачи НЕ нужно писать аналог без аналитических функций.
5. По каждому сотруднику выведите последнего клиента, которому сотрудник что-то продал.
В результатах должны быть ид и фамилия сотрудника, ид и название клиента, дата продажи, сумму сделки.
6. Выберите по каждому клиенту два самых дорогих товара, которые он покупал.
В результатах должно быть ид клиета, его название, ид товара, цена, дата покупки.

Опционально можете для каждого запроса без оконных функций сделать вариант запросов с оконными функциями и сравнить их производительность.
<hr>

**Критерии оценки:** Статус "Принято" ставится если написаны SQL-запросы, выводящие правильные результаты в соответствии с заданиями.